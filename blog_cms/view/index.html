<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf8" />
  <title>CMS</title>

  <!-- css import -->
  <!--[if lte IE 8]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <link rel="stylesheet" type="text/css" href="../css/admin-style.css">
  <link rel="stylesheet" type="text/css" href="../js/flatpickr/flatpickr.min.css">
  <!-- css import -->

  <!-- js import -->

  <script type="text/javascript" src="../js/tinymce/tinymce.min.js"></script>
  <script type="text/javascript" src="../js/flatpickr/flatpickr.min.js"></script>
  <script type="text/javascript">

  // ファイルブラウザが開かれる時に呼び出される関数
  // https://github.com/Studio-42/elFinder/wiki/Integration-with-TinyMCE-4.x を一部変更しています。
  function elFinderBrowser (field_name, url, type, win) {
      tinymce.activeEditor.windowManager.open({
          file: '../js/elFinder-2.1.12/elfinder.html', // elFinderを配置した場所を指定して下さい(絶対パス)
          title: 'ファイルのアップロード・選択',
          width: 900,
          height: 450,
          resizable: 'yes'
      }, {
          setUrl: function (url) {
              win.document.getElementById(field_name).value = url;
              if(field_name == 'post[thumbnail]'){
                win.document.getElementById('edit-meta-data-content-thumbnail').src = url;
              }
          }
      });
      return false;
  }

  tinymce.init({
      selector: "[name='post[editer]']", // id="form-post[editer]"の場所にTinyMCEを適用
      language: "ja",   // 言語 = 日本語

      plugins: "textcolor image link lists", // [追加] 1. 画像挿入ボタンを有効にする
      toolbar: [ // ツールバー(2段)
          // 戻る 進む | フォーマット | 太字 斜体 | 左寄せ 中央寄せ 右寄せ 均等割付 | 箇条書き 段落番号 インデントを減らす インデント
          "undo redo | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist | blockquote | outdent indent",
          // 文字サイズ 文字色 画像 リンク リンク解除
          "fontsizeselect forecolor image link unlink"
      ],
      file_browser_callback : elFinderBrowser // [追加] 2. ファイルブラウザの設定を行う (elFinderとの連携)
  });
  </script>
  <!-- js import -->
</head>
<body>

<div class="main-wrapper contener-full">
  <header class="main-header">
    <div class="position-top-fixed row pie-clear-fix">
      <div class="main-header-logo col-md-1">logo</div>
      <div class="main-header-site col-md-1"><a class="main-header-site-link"><div class="main-header-site-link-name">サイトを表示</div></a>
    </div>
  </header>
  <main id="main" class="row pie-clear-fix">

    <!-- side menu -->
    <aside class="main-sidebar col-md-2 col-es-12">
      <ul class="main-menu">
        <li class="main-menu-item"><a class="main-menu-item-link"><div class="main-menu-item-link-name">ホーム</div></a></li>
        <li class="main-menu-item main-menu-item-including-sub-menu now">
          <a class="main-menu-item-link"><div class="main-menu-item-link-name">ブログ</div></a>
          <ul class="main-menu-item-inner-sub-menu">
            <li class="main-menu-item-inner-sub-menu-item"><a class="main-menu-item-inner-sub-menu-item-link"><div class="main-menu-item-inner-sub-menu-item-link-name">一覧</div></a></li>
            <li class="main-menu-item-inner-sub-menu-item"><a class="main-menu-item-inner-sub-menu-item-link"><div class="main-menu-item-inner-sub-menu-item-link-name">新規投稿</div></a></li>
            <li class="main-menu-item-inner-sub-menu-item"><a class="main-menu-item-inner-sub-menu-item-link"><div class="main-menu-item-inner-sub-menu-item-link-name">カテゴリー</div></a></li>
            <li class="main-menu-item-inner-sub-menu-item"><a class="main-menu-item-inner-sub-menu-item-link"><div class="main-menu-item-inner-sub-menu-item-link-name">タグ</div></a></li>
          </ul>
        </li>
        <li class="main-menu-item main-menu-item-including-sub-menu">
          <a class="main-menu-item-link"><div class="main-menu-item-link-name">ニュース</div></a>
          <ul class="main-menu-item-inner-sub-menu">
            <li class="main-menu-item-inner-sub-menu-item"><a class="main-menu-item-inner-sub-menu-item-link"><div class="main-menu-item-inner-sub-menu-item-link-name">一覧</div></a></li>
            <li class="main-menu-item-inner-sub-menu-item"><a class="main-menu-item-inner-sub-menu-item-link"><div class="main-menu-item-inner-sub-menu-item-link-name">新規記事</div></a></li>
            <li class="main-menu-item-inner-sub-menu-item"><a class="main-menu-item-inner-sub-menu-item-link"><div class="main-menu-item-inner-sub-menu-item-link-name">カテゴリー</div></a></li>
            <li class="main-menu-item-inner-sub-menu-item"><a class="main-menu-item-inner-sub-menu-item-link"><div class="main-menu-item-inner-sub-menu-item-link-name">タグ</div></a></li>
          </ul>
        </li>
        <li class="main-menu-item main-menu-item-including-sub-menu">
          <a class="main-menu-item-link"><div class="main-menu-item-link-name">メディア</div></a>
          <ul class="main-menu-item-inner-sub-menu">
            <li class="main-menu-item-inner-sub-menu-item"><a class="main-menu-item-inner-sub-menu-item-link"><div class="main-menu-item-inner-sub-menu-item-link-name">画像</div></a></li>
            <li class="main-menu-item-inner-sub-menu-item"><a class="main-menu-item-inner-sub-menu-item-link"><div class="main-menu-item-inner-sub-menu-item-link-name">その他</div></a></li>
          </ul>
        </li>
        <li class="main-menu-item main-menu-item-including-sub-menu">
          <a class="main-menu-item-link"><div class="main-menu-item-link-name">固定ページ</div></a>
          <ul class="main-menu-item-inner-sub-menu">
            <li class="main-menu-item-inner-sub-menu-item"><a class="main-menu-item-inner-sub-menu-item-link"><div class="main-menu-item-inner-sub-menu-item-link-name">一覧</div></a></li>
            <li class="main-menu-item-inner-sub-menu-item"><a class="main-menu-item-inner-sub-menu-item-link"><div class="main-menu-item-inner-sub-menu-item-link-name">新規投稿</div></a></li>
          </ul>
        </li>
        <li class="main-menu-item main-menu-item-including-sub-menu">
          <a class="main-menu-item-link"><div class="main-menu-item-link-name">設定</div></a>
          <ul class="main-menu-item-inner-sub-menu">
            <li class="main-menu-item-inner-sub-menu-item"><a class="main-menu-item-inner-sub-menu-item-link"><div class="main-menu-item-inner-sub-menu-item-link-name">簡易設定</div></a></li>
            <li class="main-menu-item-inner-sub-menu-item"><a class="main-menu-item-inner-sub-menu-item-link"><div class="main-menu-item-inner-sub-menu-item-link-name">詳細設定</div></a></li>
          </ul>
        </li>
      </ul>
    </aside>
    <!-- /side menu -->

    <div class="main-content col-md-10 col-md-2-offset col-es-12">

      <!-- post form -->
      <form method="post" action="./test.php">
        <div class="row editer-content pie-clear-fix">
          <h1 class="cms-menu-title">新規ブログ記事投稿</h1>
          <div class="col-md-8 col-es-12">
            <input class="post-title" type="text" name="post[title]" id="form-post[title]" value="" />

            <!-- edit textarea -->
            <textarea id="form-post[editer]" name="post[editer]">最初に入力しておきたい文章</textarea>
            <!-- /edit textarea -->

          </div>
          <div class="col-md-4 col-es-12 edit-meta-data-wrapper">

            <!-- setting -->
            <div class="edit-meta-data-stat">
              <div class="edit-meta-data-title-wrapper">
                <h3 class="edit-meta-data-title">設定</h3>
              </div>
              <div class="edit-meta-data-content-wrapper">
                <dl class="edit-meta-data-row pie-clear-fix">
                  <dt class="edit-meta-data-name">ステータス:</dt>
                  <dd class="edit-meta-data-data">
                    <select name="post[stat]" id="form-post[stat]">
                      <option value="3">下書き</option>
                      <option value="1">公開</option>
                      <option value="2">レビュー待ち</option>
                      <option value="0">非公開</option>
                    </select>
                  </dd>
                </dl>
                <dl class="edit-meta-data-row pie-clear-fix">
                  <dt class="edit-meta-data-name">公開開始日:</dt>
                  <dd class="edit-meta-data-data">
                    <input type="text" name="post[opendate]" id="form-post[opendate]" name="post[opendate]" value="" />
                  </dd>
                </dl>
                <dl class="edit-meta-data-row pie-clear-fix">
                  <dt class="edit-meta-data-name">公開終了日:</dt>
                  <dd class="edit-meta-data-data">
                    <input type="text" name="post[closedate]" id="form-post[closedate]" name="post[closedate]" value="" />
                  </dd>
                </dl>
                <input type="submit" name="post[regist]" id="form-post[regist]" value="送信" />
              </div>
            </div>
            <!-- /setting -->

            <!-- category -->
            <div class="edit-meta-data-stat">
              <div class="edit-meta-data-title-wrapper">
                <h3 class="edit-meta-data-title">カテゴリー</h3>
              </div>
              <div class="edit-meta-data-content-wrapper">
                <ul class="edit-meta-data-categorys">
                  <li class="edit-meta-data-categorys-item"><label class="checkbox-label"><input type="checkbox" value="1" id="form-post[category][0]" name="post[category][0]" />テスト1</label></li>
                  <li class="edit-meta-data-categorys-item"><label class="checkbox-label"><input type="checkbox" value="1" id="form-post[category][1]" name="post[category][1]" />テスト2</label></li>
                  <li class="edit-meta-data-categorys-item"><label class="checkbox-label"><input type="checkbox" value="1" id="form-post[category][2]" name="post[category][2]" />テスト3</label></li>
                </ul>
              </div>
            </div>
            <!-- /category -->

            <!-- tags -->
            <div class="edit-meta-data-stat">
              <div class="edit-meta-data-title-wrapper">
                <h3 class="edit-meta-data-title">タグ</h3>
              </div>
              <div class="edit-meta-data-content-wrapper">
                <input type="text" id="form-post[tags]" name="post[tags]" value="" />
              </div>
            </div>
            <!-- /tags -->

            <!-- thumbnail -->
            <div class="edit-meta-data-stat">
              <div class="edit-meta-data-title-wrapper">
                <h3 class="edit-meta-data-title">サムネイル</h3>
              </div>
              <div class="edit-meta-data-content-wrapper">
                <input type="hidden" id="form-post[thumbnail]" name="post[thumbnail]" value="" />
                <img id="edit-meta-data-content-thumbnail" class="edit-meta-data-content-thumbnail" src="" />
                <input type="button" name="submit" value="画像選択" onclick="elFinderBrowser('post[thumbnail]'); return false;" />
              </div>
            </div>
            <!-- /thumbnail -->

          </div>
        </div>
      </form>
      <!-- /post form -->

    </div>
  </main>
  <footer class="main-footer contener-full">
    <div class="main-footer-copyright">Kyuacare&copy;2017</div>
  </footer>
</div>

<script type="text/javascript">
// datepicker
flatpickr("[id='form-post[opendate]']", {
  defaultDate: new Date(),
  enableTime: true,
});
flatpickr("[id='form-post[closedate]']", {
  defaultDate: new Date(),
  enableTime: true,
});
</script>

</body>
</html>
